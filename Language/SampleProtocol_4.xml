<protocol name="SampleProtocol" majorVer="4" minorVer="0">
    <members>
        <message name="LoginPublicRequest" id="0" size="16">
            <fields>
                <field name="Name" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="LoginPrivateRequest" id="1" size="16">
            <fields>
                <field name="Name" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="PasswordRequest" id="2" size="16">
            <fields>
                <field name="Token" offset="8" type="bytes" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="PasswordResponse" id="3" size="16">
            <fields>
                <field name="EncodedToken" offset="8" type="bytes" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="LoginAccept" id="4" size="8"/>
        <message name="LoginReject" id="5" size="16">
            <fields>
                <field name="Text" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="Logout" id="6" size="8"/>
        <message name="SubscribeRequest" id="7" size="8"/>
        <message name="SubscribeAccept" id="8" size="8"/>
        <message name="SubscribeReject" id="9" size="16">
            <fields>
                <field name="Text" offset="8" type="string" optional="N" repeatable="N"/>
            </fields>
        </message>
        <message name="UnsubscribeRequest" id="10" size="8"/>
        <message name="UnsubscribeAccept" id="11" size="8"/>
        <enum name="Side" size="4">
            <members>
                <member name="Bid" value="0"/>
                <member name="Ask" value="1"/>
            </members>
        </enum>
        <group name="SnapshotRefreshEntry" size="20">
            <fields>
                <field name="Side" offset="0" type="Side" optional="N" repeatable="N"/>
                <field name="Qty" offset="4" type="int32" optional="N" repeatable="N"/>
                <field name="Price" offset="8" type="double" optional="N" repeatable="N"/>
                <field name="Orders" offset="16" type="int32" optional="N" repeatable="N"/>
            </fields>
        </group>
        <message name="SnapshotRefresh" id="12" size="24">
            <fields>
                <field name="Symbol" offset="8" type="string" optional="N" repeatable="N"/>
                <field name="Entries" offset="16" type="SnapshotRefreshEntry" optional="N" repeatable="Y"/>
            </fields>
        </message>
        <processor name="Client" head="83_9">
            <states>
                <state label="83_9">
                    <operations>
                        <send name="loginPublic" next="85_13">
                            <messages>
                                <message name="LoginPublicRequest"/>
                            </messages>
                        </send>
                        <send name="loginPrivate" next="95_13">
                            <messages>
                                <message name="LoginPrivateRequest"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="85_13">
                    <operations>
                        <recv name="onPublicLoginAccept" next="L1">
                            <messages>
                                <message name="LoginAccept"/>
                            </messages>
                        </recv>
                        <recv name="onPublicLoginReject">
                            <messages>
                                <message name="LoginReject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="loginPublic"/>
                    </contexts>
                </state>
                <state label="95_13">
                    <operations>
                        <recv name="onPassword" next="97_17">
                            <messages>
                                <message name="PasswordRequest"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="loginPrivate"/>
                    </contexts>
                </state>
                <state label="97_17">
                    <operations>
                        <send next="99_21">
                            <messages>
                                <message name="PasswordResponse"/>
                            </messages>
                        </send>
                    </operations>
                    <contexts>
                        <context name="loginPrivate"/>
                    </contexts>
                </state>
                <state label="99_21">
                    <operations>
                        <recv name="onPrivateLoginAccept" next="L1">
                            <messages>
                                <message name="LoginAccept"/>
                            </messages>
                        </recv>
                        <recv name="onPrivateLoginReject">
                            <messages>
                                <message name="LoginReject"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="loginPrivate"/>
                    </contexts>
                </state>
                <state label="L1">
                    <operations>
                        <send name="subscribe" next="114_17">
                            <messages>
                                <message name="SubscribeRequest"/>
                            </messages>
                        </send>
                        <send name="logout" next="128_17">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                        <recv name="onLogout">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="114_17">
                    <operations>
                        <recv name="onSubscribeAccept" next="L2">
                            <messages>
                                <message name="SubscribeAccept"/>
                            </messages>
                        </recv>
                        <recv name="onSubscribeReject" next="L1">
                            <messages>
                                <message name="SubscribeReject"/>
                            </messages>
                        </recv>
                        <recv name="onLogout">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="subscribe"/>
                    </contexts>
                </state>
                <state label="128_17">
                    <operations>
                        <recv>
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="logout"/>
                    </contexts>
                </state>
                <state label="L2">
                    <operations>
                        <recv name="onSnapshot" next="L2">
                            <messages>
                                <message name="SnapshotRefresh"/>
                            </messages>
                        </recv>
                        <send name="unsubscribe" next="144_17">
                            <messages>
                                <message name="UnsubscribeRequest"/>
                            </messages>
                        </send>
                        <send name="logout" next="158_17">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                        <recv name="onLogout">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="144_17">
                    <operations>
                        <recv next="144_17">
                            <messages>
                                <message name="SnapshotRefresh"/>
                            </messages>
                        </recv>
                        <recv next="L1">
                            <messages>
                                <message name="UnsubscribeAccept"/>
                            </messages>
                        </recv>
                        <recv name="onLogout">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="unsubscribe"/>
                    </contexts>
                </state>
                <state label="158_17">
                    <operations>
                        <recv next="158_17">
                            <messages>
                                <message name="SnapshotRefresh"/>
                            </messages>
                        </recv>
                        <recv>
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                    <contexts>
                        <context name="logout"/>
                    </contexts>
                </state>
            </states>
        </processor>
        <processor name="Server" head="176_9">
            <states>
                <state label="176_9">
                    <operations>
                        <recv name="onLoginPublic" next="178_13">
                            <messages>
                                <message name="LoginPublicRequest"/>
                            </messages>
                        </recv>
                        <recv name="onLoginPrivate" next="188_13">
                            <messages>
                                <message name="LoginPrivateRequest"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="178_13">
                    <operations>
                        <send next="205_13">
                            <messages>
                                <message name="LoginAccept"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="LoginReject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="188_13">
                    <operations>
                        <send next="190_17">
                            <messages>
                                <message name="PasswordRequest"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="190_17">
                    <operations>
                        <recv name="onPassword" next="192_21">
                            <messages>
                                <message name="PasswordResponse"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="192_21">
                    <operations>
                        <send next="205_13">
                            <messages>
                                <message name="LoginAccept"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="LoginReject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="205_13">
                    <operations>
                        <recv name="onSubscribe" next="207_17">
                            <messages>
                                <message name="SubscribeRequest"/>
                            </messages>
                        </recv>
                        <recv name="onLogout" next="217_17">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                        <send>
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="207_17">
                    <operations>
                        <send next="227_13">
                            <messages>
                                <message name="SubscribeAccept"/>
                            </messages>
                        </send>
                        <send next="205_13">
                            <messages>
                                <message name="SubscribeReject"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="217_17">
                    <operations>
                        <send>
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="227_13">
                    <operations>
                        <send next="227_13">
                            <messages>
                                <message name="SnapshotRefresh"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                        <recv name="onUnsubscribe" next="237_17">
                            <messages>
                                <message name="UnsubscribeRequest"/>
                            </messages>
                        </recv>
                        <recv name="onLogout" next="250_17">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </recv>
                    </operations>
                </state>
                <state label="237_17">
                    <operations>
                        <send next="237_17">
                            <messages>
                                <message name="SnapshotRefresh"/>
                            </messages>
                        </send>
                        <send next="205_13">
                            <messages>
                                <message name="UnsubscribeAccept"/>
                            </messages>
                        </send>
                        <send next="205_13">
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                    </operations>
                </state>
                <state label="250_17">
                    <operations>
                        <send next="250_17">
                            <messages>
                                <message name="SnapshotRefresh"/>
                            </messages>
                        </send>
                        <send>
                            <messages>
                                <message name="Logout"/>
                            </messages>
                        </send>
                    </operations>
                </state>
            </states>
        </processor>
    </members>
</protocol>
